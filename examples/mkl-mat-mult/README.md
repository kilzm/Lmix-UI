# Example 1 - "mkl-mat-mult"

A useless fortran program that performs a large matrix multiplication with the dgemm subroutine from the LAPACK implementation of the Intel oneAPI Math Kernel Library.

## Building with modules

Load the following modules:
* intel-oneapi-mkl
* intel-oneapi-ifort
* intel-oneapi-compilers/2021.9.0

The Makefile specifies two targets: `mat_mult_seq` and `mat_mult_par` where the first one runs sequential and the second one linking with implicit openmp which results in a faster execution time.
```
$ make mat_mult_seq
$ make mat_mult_par
```

## Flake generation

The flake has been autogenerated using lmod2flake:

```
$ nix run . -- ./examples/mkl-mat-mult
```

The variable `MKL_BASE` required by the Makefile needs to be set manually in the flake.

## Building

The Makefile specifies two targets: `mat_mult_seq` and `mat_mult_par` where the first one runs sequential and the second one linking with implicit openmp which results in a faster execution time.

```
$ nix develop -i
$ make mat_mult_seq
$ make mat_mult_par
```
